<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Bot plays Tic-Tac-Toe using N-step lookahead | Techcopia</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Bot plays Tic-Tac-Toe using N-step lookahead" />
<meta name="author" content="Rishabh Goel" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Good to see you! In this article we will design a bot which can play Tic-Tac-Toe using N-Step Lookahead, a.k.a minimax. In the previous article, we created a bot which played using one-step lookahead. However, this time our bot will look ahead much further into the future rather than just one-step." />
<meta property="og:description" content="Good to see you! In this article we will design a bot which can play Tic-Tac-Toe using N-Step Lookahead, a.k.a minimax. In the previous article, we created a bot which played using one-step lookahead. However, this time our bot will look ahead much further into the future rather than just one-step." />
<link rel="canonical" href="http://localhost:4000/blog/reinforcement-learning/n-step-lookahead-tictactoe.html" />
<meta property="og:url" content="http://localhost:4000/blog/reinforcement-learning/n-step-lookahead-tictactoe.html" />
<meta property="og:site_name" content="Techcopia" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-05T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bot plays Tic-Tac-Toe using N-step lookahead" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/blog/reinforcement-learning/n-step-lookahead-tictactoe.html","description":"Good to see you! In this article we will design a bot which can play Tic-Tac-Toe using N-Step Lookahead, a.k.a minimax. In the previous article, we created a bot which played using one-step lookahead. However, this time our bot will look ahead much further into the future rather than just one-step.","headline":"Bot plays Tic-Tac-Toe using N-step lookahead","dateModified":"2021-12-05T00:00:00+05:30","datePublished":"2021-12-05T00:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/reinforcement-learning/n-step-lookahead-tictactoe.html"},"author":{"@type":"Person","name":"Rishabh Goel"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/main.css">
  <link rel="shortcut icon" type="image/ico" href="/blog/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon-16x16.png"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/blog/feed.xml" title="Techcopia" /><meta name="google-site-verification" content="ed7E7DKesZM2qv5PWcE9XcCBAThpRjK6I0Min5AzK-c" />
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Techcopia</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Bot plays Tic-Tac-Toe using N-step lookahead</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-12-05T00:00:00+05:30" itemprop="datePublished">Published: Dec 5, 2021 •</time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Rishabh Goel</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Good to see you! In this article we will design a bot which can play Tic-Tac-Toe
using <a href="https://en.wikipedia.org/wiki/Minimax">N-Step Lookahead</a>, a.k.a minimax. In the <a href="/blog//reinforcement-learning/one-step-lookahead-tictactoe.html">previous article</a>, we created a
bot which played using one-step lookahead. However, this time our bot will look
ahead much further into the future rather than just one-step.</p>

<h2 id="import-packages">Import packages</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">util</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div></div>

<h2 id="create-the-battlefield">Create the battlefield</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ttt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint16</span><span class="p">)</span>
<span class="n">ttt</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[0, 0, 0],
       [0, 0, 0],
       [0, 0, 0]], dtype=uint16)
</code></pre></div></div>

<h2 id="code-functions">Code functions</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_valid_moves</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
    <span class="n">valid_moves</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">valid_moves</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">valid_moves</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_win_draw</span><span class="p">(</span><span class="n">ttt</span><span class="p">):</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">ttt</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">draw</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">).</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">draw</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">break</span>
    <span class="c1"># check rows
</span>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="n">row</span><span class="p">,:]).</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="n">row</span><span class="p">,:]).</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span>
    <span class="c1"># check columns
</span>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[:,</span><span class="n">col</span><span class="p">]).</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[:,</span><span class="n">col</span><span class="p">]).</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span>
    <span class="c1"># Check diagonals
</span>    <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]).</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]).</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]).</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]).</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">draw</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></div>

<h2 id="n-step-lookahead">N-Step Lookahead</h2>

<p>In one-step lookahead, <code class="language-plaintext highlighter-rouge">get_heuristic</code> did not check for opponent’s three tiles
in a sequence. Since it was never a possiblity for play to resume once either of
the players placed three tiles in sequence. In n-step lookahead, however, we
try to anticipate opponent’s moves by playing any possible moves on a <em>test board</em>.
Thus we will modify <code class="language-plaintext highlighter-rouge">get_heuristic</code> function to take this into account.</p>

<h3 id="scoring-scheme">Scoring Scheme</h3>
<p>(for player)</p>

<ul>
  <li>3-in-sequence: 100,000</li>
  <li>2-in-sequence: 1</li>
</ul>

<p>(for opponent)</p>

<ul>
  <li>2-in-sequence: -100</li>
  <li>3-in-sequence: -1,000
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_heuristic</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
  <span class="s">"""
  Evaluates move and assigns a score.
    
  Parameters:
  ===========
  grid: numpy.ndarray
      --&gt; 3x3 Tic-Tac-Toe grid
    
  player: int
      --&gt; 1(X) or 2(O) to denote the player
    
  Returns:
  ========
  score: int
      --&gt; score the game board received
  """</span>
  <span class="n">num_three</span> <span class="o">=</span> <span class="n">count_windows</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
  <span class="n">num_twos</span> <span class="o">=</span> <span class="n">count_windows</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
  <span class="n">num_twos_opp</span> <span class="o">=</span> <span class="n">count_windows</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">player</span><span class="o">%</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">num_three_opp</span> <span class="o">=</span> <span class="n">count_windows</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">player</span><span class="o">%</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">score</span> <span class="o">=</span> <span class="mf">1e5</span><span class="o">*</span><span class="n">num_three</span> <span class="o">+</span> <span class="n">num_twos</span> <span class="o">-</span> <span class="mf">1e2</span><span class="o">*</span><span class="n">num_twos_opp</span> <span class="o">-</span> <span class="mf">1e3</span><span class="o">*</span><span class="n">num_three_opp</span>
  <span class="k">return</span> <span class="n">score</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>The next function is the core of our n-step lookahead algorithm. According to,
our common friend, wikipedia:</p>

<blockquote>
  <p>A minimax algorithm is a recursive algorithm for choosing the next move in an n-player game, usually a two-player game. A value is associated with each position or state of the game. This value is computed by means of a position evaluation function and it indicates how good it would be for a player to reach that position. The player then makes the move that maximizes the minimum value of the position resulting from the opponent’s possible following moves. If it is A’s turn to move, A gives a value to each of their legal moves.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">minimax</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">maximising</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">check_win_draw</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">heuristic</span> <span class="o">=</span> <span class="n">get_heuristic</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">player</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">heuristic</span>
    <span class="n">ttt</span> <span class="o">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">maximising</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="mb">0b1</span><span class="o">&lt;&lt;</span><span class="mi">20</span>
        <span class="k">for</span> <span class="n">valid_move</span> <span class="ow">in</span> <span class="n">get_valid_moves</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
            <span class="n">ttt</span><span class="p">[</span><span class="n">valid_move</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">minimax</span><span class="p">(</span><span class="n">ttt</span><span class="p">,</span><span class="n">depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">player</span><span class="o">%</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">False</span><span class="p">))</span>
            <span class="n">ttt</span><span class="p">[</span><span class="n">valid_move</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="mb">0b1</span><span class="o">&lt;&lt;</span><span class="mi">20</span>
        <span class="k">for</span> <span class="n">valid_move</span> <span class="ow">in</span> <span class="n">get_valid_moves</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">minimax</span><span class="p">(</span><span class="n">ttt</span><span class="p">,</span><span class="n">depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">player</span><span class="o">%</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="bp">True</span><span class="p">))</span>
            <span class="n">ttt</span><span class="p">[</span><span class="n">valid_move</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">value</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">score_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">move</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="s">"""
    Helper function for `get_optimal_move` to score each valid_move.
    """</span>
    <span class="n">ttt</span> <span class="o">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ttt</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">minimax</span><span class="p">(</span><span class="n">ttt</span><span class="p">,</span> <span class="n">depth</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>

<span class="k">def</span> <span class="nf">get_optimal_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="s">"""
    Uses minimax to find the best possible move.

    Parameters:
    ===========
    grid: numpy.ndarray
        --&gt; 3x3 Tic-Tac-Toe grid
    
    depth: int
        --&gt; denotes the value of n in n-step lookahead. The max depth of tree
        --&gt; in minimax algorithm.
    
    player: int
        --&gt; 1(X) or 2(O) to represent the player.
    
    Returns:
    ========
    : tuple
        --&gt; Return (row, col) pair to represent the move in the grid
    """</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">valid_moves</span> <span class="o">=</span> <span class="n">get_valid_moves</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">valid_move</span> <span class="ow">in</span> <span class="n">valid_moves</span><span class="p">:</span>
        <span class="n">scores</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">score_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">valid_move</span><span class="p">,</span> <span class="n">player</span><span class="p">))</span>
    <span class="n">max_score</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
    <span class="n">max_score_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">score</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="n">max_score</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">valid_moves</span><span class="p">[</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">max_score_indices</span><span class="p">)]</span>
</code></pre></div></div>

<h2 id="time-to-battle">Time to battle!</h2>

<h3 id="against-self">Against self</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">agent1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">agent2</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s">'total_games'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'agent1'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'agent2'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'draws'</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="n">ngames</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">depth</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ngames</span><span class="p">):</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="s">'total_games'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">iteration</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">get_optimal_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">])</span>
            <span class="n">grid</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">get_optimal_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="n">agent2</span><span class="p">[</span><span class="s">'piece'</span><span class="p">])</span>
            <span class="n">grid</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent2</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">check_win_draw</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">game_result</span> <span class="o">=</span> <span class="n">check_win_draw</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">game_result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent1'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">game_result</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent2'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'draws'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">break</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                          Stats                       
    --------------------------------------------------
    Total Games:100   Agent1:40    Agent2:19    Draws:41   
</code></pre></div></div>
<h3 id="against-random-bot">Against Random bot</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">agent1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">agent2</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s">'total_games'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'agent1'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'agent2'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'draws'</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="n">ngames</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">depth</span> <span class="o">=</span> <span class="mi">3</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ngames</span><span class="p">):</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="s">'total_games'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">iteration</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">get_optimal_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">depth</span><span class="p">,</span><span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">])</span>
            <span class="n">grid</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">get_random_tile</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="n">grid</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent2</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">check_win_draw</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">game_result</span> <span class="o">=</span> <span class="n">check_win_draw</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">game_result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent1'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">game_result</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent2'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'draws'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">break</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                          Stats                       
    --------------------------------------------------
    Total Games:100   Agent1:100   Agent2:0     Draws:0    
</code></pre></div></div>

  </div><a class="u-url" href="/blog/reinforcement-learning/n-step-lookahead-tictactoe.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Techcopia</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Techcopia</li><li><a class="u-email" href="mailto:coder_g@pm.me">coder_g@pm.me</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Coder-RG"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Coder-RG</span></a></li><li><a href="https://www.linkedin.com/in/r1shabhg0el"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">r1shabhg0el</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A blog containing articles on reinforcement learning.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
