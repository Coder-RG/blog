<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Bot plays Tic-Tac-Toe using One-step lookahead | Techcopia</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Bot plays Tic-Tac-Toe using One-step lookahead" />
<meta name="author" content="Rishabh Goel" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Welcome Back! In this article we will design an agent that uses one-step lookahead to decide the best move. In the previous article, our agent played random moves which didn’t turn out very successful with win rate of 59%(against another random agent)." />
<meta property="og:description" content="Welcome Back! In this article we will design an agent that uses one-step lookahead to decide the best move. In the previous article, our agent played random moves which didn’t turn out very successful with win rate of 59%(against another random agent)." />
<link rel="canonical" href="http://localhost:4000/blog/reinforcement-learning/one-step-lookahead-tictactoe.html" />
<meta property="og:url" content="http://localhost:4000/blog/reinforcement-learning/one-step-lookahead-tictactoe.html" />
<meta property="og:site_name" content="Techcopia" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-18T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bot plays Tic-Tac-Toe using One-step lookahead" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/blog/reinforcement-learning/one-step-lookahead-tictactoe.html","description":"Welcome Back! In this article we will design an agent that uses one-step lookahead to decide the best move. In the previous article, our agent played random moves which didn’t turn out very successful with win rate of 59%(against another random agent).","headline":"Bot plays Tic-Tac-Toe using One-step lookahead","dateModified":"2021-11-18T00:00:00+05:30","datePublished":"2021-11-18T00:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/reinforcement-learning/one-step-lookahead-tictactoe.html"},"author":{"@type":"Person","name":"Rishabh Goel"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/main.css">
  <link rel="shortcut icon" type="image/ico" href="/blog/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon-16x16.png"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/blog/feed.xml" title="Techcopia" /><meta name="google-site-verification" content="ed7E7DKesZM2qv5PWcE9XcCBAThpRjK6I0Min5AzK-c" />
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Techcopia</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Bot plays Tic-Tac-Toe using One-step lookahead</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-11-18T00:00:00+05:30" itemprop="datePublished">Published: Nov 18, 2021 •</time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Rishabh Goel</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Welcome Back! In this article we will design an agent that uses <a href="https://www.kaggle.com/alexisbcook/one-step-lookahead">one-step lookahead</a> to decide the best move. In the <a href="/blog//reinforcement-learning/random-tictactoe.html">previous article</a>, our agent played random moves which didn’t turn out very successful with win rate of 59%(against another random agent).</p>

<p>This time around, I propose that we give our agent some intellect. What do I mean? Well, we will design the agent so that it looks at all the possible moves and then decides the best move.
This is much better than playing random moves, since it will play optimally at each step. However, we will look in the upcoming article that this is not the most best method.</p>

<h2 id="import-packages">Import packages</h2>
<p>Let’s start by importing the necessary packages.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">util</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div></div>
<p>util is a python file containing some of the code from previous article. You can find all the code <a href="https://github.com/Coder-RG/blog-content/tictactoe">here</a>.</p>

<h2 id="lets-create-the-battlefield">Let’s create the battlefield</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ttt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint16</span><span class="p">)</span>
<span class="n">ttt</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[0, 0, 0],
       [0, 0, 0],
       [0, 0, 0]], dtype=uint16)
</code></pre></div></div>

<p>Code for playing randomly was very simple. However, this time around we need to write a lot of lines.</p>

<h2 id="create-the-necessary-functions">Create the necessary functions</h2>

<p>All the functions contain docstring so as to help you understand their functionality.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_valid_moves</span><span class="p">(</span><span class="n">ttt</span><span class="p">):</span>
    <span class="s">"""
    Get positions in the grid that are empty.
    
    Parameters:
    ===========
    ttt: numpy.ndarray
        --&gt; Tic-Tac-Toe grid.
    
    Returns:
    ========
    valid_moves: list
        --&gt; Grid positions which are empty.
    """</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">ttt</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">grid</span><span class="p">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,):</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
    <span class="n">valid_moves</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">valid_moves</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="s">"""Count the player tiles in the concerned window and the remaining tiles
    should be empty. This will ensure that the player can play further in
    those tiles.
    
    For example,
    
         1 2 3  |  1 2 3
      1  X - X  |  - - X
      2  O - -  |  O - X
      3  O X O  |  O X -
    
    In the first grid for first column(X O O), if we were to check for this
    window, we can see that 'O' has better outcome with 2 of its pieces in
    a sequence, however, since there are no further tiles to play thus,
    should not be awarded high score.
    
    Moreover, in the second grid, the first column is much better to play
    a piece by the player "O", since there is an empty tile where further
    play is possible.
    
    Parameters:
    ===========
    window: list
        --&gt; consecutive tiles to score
        
    seq: int
        --&gt; number of same pieces to count
        
    player: int
        --&gt; the player piece to count, eg: 1(X) or 2(O)
    
    Return:
    =======
    :boolean
    
    """</span>
    <span class="k">return</span> <span class="n">window</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">player</span><span class="p">)</span> <span class="o">==</span> <span class="n">seq</span> <span class="ow">and</span> <span class="n">window</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="o">-</span><span class="n">seq</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">count_windows</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="s">"""
    Counts the number of windows that satisfy the given parameters,
    i.e. for the given player and the amount of pieces in a window.
    
    Parameters:
    ===========
    grid: numpy.ndarray
        --&gt; 3x3 Tic Tac Toe grid
    
    seq: int
        --&gt; number of same pieces to count
    
    player: int
        --&gt; the player piece to count, eg: 1(Player 1) or 2(Player 2)
    
    Return:
    =======
    windows: int
        --&gt; number of windows that satisfy the given criteria.
    """</span>
    <span class="n">windows</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Horizontal(row)
</span>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">grid</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">check_window</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="n">seq</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
            <span class="n">windows</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c1"># Vertical(column)
</span>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">check_window</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">grid</span><span class="p">[:,</span><span class="n">col</span><span class="p">]),</span> <span class="n">seq</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
            <span class="n">windows</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="c1"># Diagonal
</span>    <span class="n">window</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">check_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="n">windows</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">window</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">check_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
        <span class="n">windows</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">windows</span>
</code></pre></div></div>

<h2 id="one-step-lookahead">One step lookahead</h2>

<p>The above code will help in implementing One-step lookahead but what exactly is it?</p>

<h3 id="algorithmsimplified">Algorithm(Simplified)</h3>

<blockquote>
  <p>While game not done:</p>
  <ol>
    <li>For each valid move in valid moves:
      <ul>
        <li>play the move</li>
        <li>evaluate the play and assign a score</li>
      </ul>
    </li>
    <li>select all plays with score = highest score</li>
    <li>If highest score is unique play that move</li>
    <li>else choose randomly</li>
  </ol>
</blockquote>

<h3 id="move-scoring">Move scoring</h3>
<ul>
  <li>+1000 if won i.e XXX or OOO</li>
  <li>+1 if next move will win the game i.e, XX or OO</li>
  <li>-100 if opponent will win in next move i.e it already has a sequence of 2.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_heuristic</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="s">"""
    Evaluates move and assigns a score.
    
    Parameters:
    ===========
    grid: numpy.ndarray
        --&gt; 3x3 Tic-Tac-Toe grid
    
    player: int
        --&gt; 1(X) or 2(O) to denote the player
    
    Returns:
    ========
    score: int
        --&gt; score the game board received
    """</span>
    <span class="n">num_threes</span> <span class="o">=</span> <span class="n">count_windows</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
    <span class="n">num_twos</span> <span class="o">=</span> <span class="n">count_windows</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">player</span><span class="p">)</span>
    <span class="n">num_twos_opp</span> <span class="o">=</span> <span class="n">count_windows</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">player</span><span class="o">%</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="mf">1e3</span><span class="o">*</span><span class="n">num_threes</span> <span class="o">+</span> <span class="n">num_twos</span> <span class="o">-</span> <span class="mf">1e2</span><span class="o">*</span><span class="n">num_twos_opp</span>
    <span class="k">return</span> <span class="n">score</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">score_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">move</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="s">"""
    Gets the score for a single move played.

    Parameters:
    ===========
    grid: numpy.ndarray
        --&gt; 3x3 Tic-Tac-Toe grid

    move: int
        --&gt; index where the play is performed. The grid is converted to a
            sequential array of shape (9,). Thus the move is a value between
            0...8
    """</span>
    <span class="n">ttt</span> <span class="o">=</span> <span class="n">grid</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">ttt</span><span class="p">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,):</span>
        <span class="n">ttt</span> <span class="o">=</span> <span class="n">ttt</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ttt</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="s">"Invalid Move"</span>
    <span class="n">ttt</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">player</span>
    <span class="k">return</span> <span class="n">get_heuristic</span><span class="p">(</span><span class="n">ttt</span><span class="p">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="n">player</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_optimal_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">player</span><span class="p">):</span>
    <span class="s">"""
    Return the best move to play out of all the possible moves.

    Parameters:
    ===========
    grid: numpy.ndarray
        --&gt; 3x3 Tic-Tac-Toe grid
    
    player: int
        --&gt; 1(X) or 2(O) to denote the player
    """</span>
    <span class="n">valid_moves</span> <span class="o">=</span> <span class="n">get_valid_moves</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">valid_move</span> <span class="ow">in</span> <span class="n">valid_moves</span><span class="p">:</span>
        <span class="n">scores</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">score_move</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">valid_move</span><span class="p">,</span> <span class="n">player</span><span class="p">))</span>
    <span class="n">max_score</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
    <span class="n">max_score_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">score</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="n">max_score</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">valid_moves</span><span class="p">[</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">max_score_indices</span><span class="p">)]</span>
</code></pre></div></div>

<h2 id="putting-it-all-together">Putting it all together</h2>

<p>First, our new agent will compete against random agent. Fingers crossed!</p>

<h3 id="against-random-agent">Against Random Agent</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">agent1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">agent2</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s">'agent1'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'agent2'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'draws'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'total_games'</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="n">ngames</span> <span class="o">=</span> <span class="mi">100</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ngames</span><span class="p">):</span>
    <span class="c1"># Reset the grid
</span>    <span class="n">ttt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="s">'total_games'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="c1"># Optimal Agent
</span>        <span class="k">if</span> <span class="n">iteration</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">get_optimal_move</span><span class="p">(</span><span class="n">ttt</span><span class="p">,</span> <span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">])</span>
            <span class="n">ttt</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="c1"># Dumb Agent
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">get_random_tile</span><span class="p">(</span><span class="n">ttt</span><span class="p">)</span>
            <span class="n">ttt</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent2</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="n">winner</span> <span class="o">=</span> <span class="n">check_win</span><span class="p">(</span><span class="n">ttt</span><span class="p">)</span>
        <span class="n">clear_output</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">winner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">winner</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent1'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent2'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">winner</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s">'draws'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">print_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                          Stats                       
    --------------------------------------------------
    Total Games:100   Agent1:98    Agent2:1     Draws:1 
</code></pre></div></div>

<p>Woohoo! Our agent won 98-1 against random agent. This is a significant improvement. Now let’s compete lookahead agent with a copy of itself.</p>

<h3 id="against-replica-of-self">Against replica of self</h3>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">agent1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">agent2</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s">'agent1'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'agent2'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'draws'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'total_games'</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="n">ngames</span> <span class="o">=</span> <span class="mi">100</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ngames</span><span class="p">):</span>
    <span class="n">ttt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="s">'total_games'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">iteration</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">get_optimal_move</span><span class="p">(</span><span class="n">ttt</span><span class="p">,</span> <span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">])</span>
            <span class="n">ttt</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">move</span> <span class="o">=</span> <span class="n">get_optimal_move</span><span class="p">(</span><span class="n">ttt</span><span class="p">,</span> <span class="n">agent2</span><span class="p">[</span><span class="s">'piece'</span><span class="p">])</span>
            <span class="n">ttt</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">9</span><span class="p">)[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent2</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="n">winner</span> <span class="o">=</span> <span class="n">check_win</span><span class="p">(</span><span class="n">ttt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">winner</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">winner</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent1'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent2'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">winner</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s">'draws'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">print_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                          Stats                       
    --------------------------------------------------
    Total Games:100   Agent1:30    Agent2:24    Draws:46
</code></pre></div></div>

<p>Fascinating. There are more draws than either agent’s wins.</p>

<p>This brings an end to our one-step lookahead agent build. I hope this interested you to look out for the next article where we will implement the n-step lookahead agent.</p>


  </div><a class="u-url" href="/blog/reinforcement-learning/one-step-lookahead-tictactoe.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Techcopia</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Techcopia</li><li><a class="u-email" href="mailto:coder_g@pm.me">coder_g@pm.me</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Coder-RG"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Coder-RG</span></a></li><li><a href="https://www.linkedin.com/in/r1shabhg0el"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">r1shabhg0el</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A blog containing articles on reinforcement learning.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
