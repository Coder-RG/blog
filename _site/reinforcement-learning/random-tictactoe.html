<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Bot plays Tic-Tac-Toe using Random moves | Techcopia</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Bot plays Tic-Tac-Toe using Random moves" />
<meta name="author" content="Rishabh Goel" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Welcome! This is the first article in the reinforcement learning path. In this path we will develop an agent that will be able to beat the best. Got too excited there, moving on! The agent will progress in stages. In each blog, it will become smarter in how it chooses its moves. Let’s get started, shall we?" />
<meta property="og:description" content="Welcome! This is the first article in the reinforcement learning path. In this path we will develop an agent that will be able to beat the best. Got too excited there, moving on! The agent will progress in stages. In each blog, it will become smarter in how it chooses its moves. Let’s get started, shall we?" />
<link rel="canonical" href="http://localhost:4000/blog/reinforcement-learning/random-tictactoe.html" />
<meta property="og:url" content="http://localhost:4000/blog/reinforcement-learning/random-tictactoe.html" />
<meta property="og:site_name" content="Techcopia" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-11-16T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Bot plays Tic-Tac-Toe using Random moves" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"http://localhost:4000/blog/reinforcement-learning/random-tictactoe.html","description":"Welcome! This is the first article in the reinforcement learning path. In this path we will develop an agent that will be able to beat the best. Got too excited there, moving on! The agent will progress in stages. In each blog, it will become smarter in how it chooses its moves. Let’s get started, shall we?","headline":"Bot plays Tic-Tac-Toe using Random moves","dateModified":"2021-11-16T00:00:00+05:30","datePublished":"2021-11-16T00:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/reinforcement-learning/random-tictactoe.html"},"author":{"@type":"Person","name":"Rishabh Goel"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/main.css">
  <link rel="shortcut icon" type="image/ico" href="/blog/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon-16x16.png"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/blog/feed.xml" title="Techcopia" /><meta name="google-site-verification" content="ed7E7DKesZM2qv5PWcE9XcCBAThpRjK6I0Min5AzK-c" />
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Techcopia</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Bot plays Tic-Tac-Toe using Random moves</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-11-16T00:00:00+05:30" itemprop="datePublished">Published: Nov 16, 2021 •</time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Rishabh Goel</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Welcome! This is the first article in the reinforcement learning path. In this path we will develop
an agent that will be able to beat the best. Got too excited there, moving on!
The agent will progress in stages. In each blog, it will become smarter in how it chooses its moves. Let’s get started, shall we?</p>

<h3 id="introduction-to-tic-tac-toe">Introduction to Tic-Tac-Toe</h3>
<p>If you didn’t undertand what I talked about till now, let me give a refresher. Tic-Tac-Toe consists
of a 3x3 grid and two players compete to win. One player is assigned the marker <strong>X</strong> and the other is assigned the marker <strong>O</strong>. The play alternates between the two players i.e. each player can only play in their turn. The first player to place their marker in a sequence wins. This sequence can be single row, column or diagonal.</p>

<p style="text-align: center;"><img src="/blog/assets/images/tictactoe.png" alt="Tic-Tac-Toe" /></p>

<h3 id="import-the-necessary-packages">Import the necessary packages</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">clear_output</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
</code></pre></div></div>

<h3 id="create-the-battlefield">Create the battlefield</h3>

<p>Before creating any agent, it is necessary to create the grid on which the game will be played.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ttt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint16</span><span class="p">)</span>
<span class="n">ttt</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([[0, 0, 0],
       [0, 0, 0],
       [0, 0, 0]], dtype=uint16)
</code></pre></div></div>

<h3 id="time-for-some-rules">Time for some rules</h3>

<p>After every play, we need to check if any player has won. The code below will help us in this task.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">check_win</span><span class="p">(</span><span class="n">ttt</span><span class="p">):</span>
    <span class="s">"""
    Checks for the win condition i.e, 3 sequential markers of one player.

    Paramters:
    ==========
    ttt: np.ndarray
        --&gt; 3x3 Tic-Tac-Toe grid
    
    Returns:
    ========
    : int
        --&gt; 0,1,2 where each value represent who won. 0 if none, 1 for player 1
            and 2 for player 2.
    """</span>
    <span class="c1"># check rows
</span>    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="n">row</span><span class="p">,:]).</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="n">row</span><span class="p">,:]).</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span>
    <span class="c1"># check columns
</span>    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[:,</span><span class="n">col</span><span class="p">]).</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[:,</span><span class="n">col</span><span class="p">]).</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span>
    <span class="c1"># Check diagonals
</span>    <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]).</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]).</span><span class="n">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]).</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="nb">list</span><span class="p">(</span><span class="n">ttt</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]).</span><span class="n">count</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="mi">0</span>

</code></pre></div></div>
<p>Everything has been setup, in context to the environment. Next, we will create the code for the agent’s moves. Since our agent has only just started with this game, it will be a bit dumb. How dumb? It will play random moves.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">get_random_tile</span><span class="p">(</span><span class="n">ttt</span><span class="p">):</span>
    <span class="s">"""
    Get a random location for the grid where play is possible. Only tile value
    '0' represent a valid move.

    Parameters:
    ===========
    ttt: np.ndarray
        --&gt; 3x3 Tic-Tac-Toe grid.

    Returns:
    ========
    (row,col): tuple
        --&gt; A tuple with tile location on the grid. Remember the grid is 0
            indexed.
    """</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ttt</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">)</span>

</code></pre></div></div>

<p>This is where things get exciting. All the necessary code has been developed. The agent can safely play some games now.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">agent1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">agent2</span> <span class="o">=</span> <span class="p">{</span><span class="s">'piece'</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">{</span><span class="s">'agent1'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'agent2'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'draws'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'total_games'</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
<span class="n">ngames</span> <span class="o">=</span> <span class="mi">100</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ngames</span><span class="p">):</span>
    <span class="c1"># Reset the grid
</span>    <span class="n">ttt</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="p">.</span><span class="n">uint16</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="s">'total_games'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="c1"># Agents play alternatively
</span>        <span class="n">move</span> <span class="o">=</span> <span class="n">get_random_tile</span><span class="p">(</span><span class="n">ttt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iteration</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ttt</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent1</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ttt</span><span class="p">[</span><span class="n">move</span><span class="p">]</span> <span class="o">=</span> <span class="n">agent2</span><span class="p">[</span><span class="s">'piece'</span><span class="p">]</span>
        <span class="n">winner</span> <span class="o">=</span> <span class="n">check_win</span><span class="p">(</span><span class="n">ttt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">winner</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">winner</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent1'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s">'agent2'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">winner</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s">'draws'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">print_result</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                      Stats                       
--------------------------------------------------
Total Games:100   Agent1:59    Agent2:28    Draws:13   
</code></pre></div></div>

<p>Our agent performs really poorly, which should be expected. Playing random moves is not guaranteed to win games. However, our agent still wins 59% of the games.</p>

<p>This article has just laid the groundworks. Complete code is not shown above, since it was not relevant. You can check the complete code in jupyter notebook <a href="https://github.com/Coder-RG/TTTWithDumbAgent/blob/master/TTTWithDumbAgent.ipynb">here</a></p>

  </div><a class="u-url" href="/blog/reinforcement-learning/random-tictactoe.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Techcopia</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Techcopia</li><li><a class="u-email" href="mailto:coder_g@pm.me">coder_g@pm.me</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Coder-RG"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Coder-RG</span></a></li><li><a href="https://www.linkedin.com/in/r1shabhg0el"><svg class="svg-icon"><use xlink:href="/blog/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">r1shabhg0el</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A blog containing articles on reinforcement learning.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
